<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<title data-react-helmet="true">云函数 | lightning</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="云函数 | lightning"><meta data-react-helmet="true" name="description" content="常规的数据读写接口，建议通过配置API的方式提供，云函数一种用于为配置API无法满足的需求编写接口的方式。"><meta data-react-helmet="true" property="og:description" content="常规的数据读写接口，建议通过配置API的方式提供，云函数一种用于为配置API无法满足的需求编写接口的方式。"><meta data-react-helmet="true" property="og:url" content="https://git-men.github.io/lightning-doc/lightning-doc/docs/guide/function"><link data-react-helmet="true" rel="shortcut icon" href="/lightning-doc/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://git-men.github.io/lightning-doc/lightning-doc/docs/guide/function"><link rel="stylesheet" href="/lightning-doc/styles.cb82ad05.css">
<link rel="preload" href="/lightning-doc/styles.226bd103.js" as="script">
<link rel="preload" href="/lightning-doc/runtime~main.e3f81d46.js" as="script">
<link rel="preload" href="/lightning-doc/main.d60ecdbd.js" as="script">
<link rel="preload" href="/lightning-doc/1.3de079d2.js" as="script">
<link rel="preload" href="/lightning-doc/44.64178a3e.js" as="script">
<link rel="preload" href="/lightning-doc/45.9bff3e8c.js" as="script">
<link rel="preload" href="/lightning-doc/935f2afb.a3e23e6e.js" as="script">
<link rel="preload" href="/lightning-doc/43.f7416efc.js" as="script">
<link rel="preload" href="/lightning-doc/08734d2c.82d2cef3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/lightning-doc/"><img src="/lightning-doc/img/favicon.png" alt="lighting" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/lightning-doc/img/favicon.png" alt="lighting" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Lightning</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/lightning-doc/docs/">文档</a><a class="navbar__item navbar__link" href="/lightning-doc/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/git-men/lightning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://gitee.com/gitmen/lightning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">OSC</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/lightning-doc/"><img src="/lightning-doc/img/favicon.png" alt="lighting" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/lightning-doc/img/favicon.png" alt="lighting" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Lightning</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/lightning-doc/docs/">文档</a></li><li class="menu__list-item"><a class="menu__link" href="/lightning-doc/blog">博客</a></li><li class="menu__list-item"><a href="https://github.com/git-men/lightning" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://gitee.com/gitmen/lightning" target="_blank" rel="noopener noreferrer" class="menu__link">OSC</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">新手上路</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/">简介</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/start">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/crm">示例应用：CRM -- 客户关系管理</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">使用手册</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/index">首页</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/install">安装</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">可视化配置</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/builtin">内置功能</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/permissions">权限管理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/menus">导航菜单配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/configs">项目设置</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">页面配置</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/pages">页面配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/pages-list">列表页配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/pages-form">表单页配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/pages-detail">详情页配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/pages-export">导出配置</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/api">API可视化配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/guide/charts">统计图表配置</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">二次开发参考</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/gmeta">GMeta</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/field">内置字段</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/lightning-doc/docs/guide/function">云函数</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/signal">信号</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/exception">异常处理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/shield">数据权限控制</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lightning-doc/docs/guide/settings">自定义设置</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">框架开发者指南</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lightning-doc/docs/dev/index">index</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">云函数</h1></header><div class="markdown"><p>常规的数据读写接口，建议通过配置API的方式提供，云函数一种用于为配置API无法满足的需求编写接口的方式。</p><p>按照云函数的使用场景划分，可分为三类：</p><ol><li>object 函数，即针对某条数据的操作接口，如为一个商品生成小程序码。</li><li>model 函数，即为某个model提供的扩展接口，如收取订单，同步用户等操作。</li><li>批量操作 函数，用于列表中选中的多条数据进行处理的场景。</li></ol><p>以上三种函数的编写方式几乎一致，区别仅在于他们接受的参数略有差异。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="定义云函数"></a>定义云函数<a class="hash-link" href="#定义云函数" title="Direct link to heading">#</a></h2><p>首先，在应用根目录下创建functions.py文件，用于编写云函数，写在这个文件下的云函数将会被lightning自动发现。</p><p>下面的过程与代码，均发生在应用根目录下functions.py文件里面。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="导入lightning_func装饰器"></a>导入lightning_func装饰器<a class="hash-link" href="#导入lightning_func装饰器" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightning</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">decorators </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> lightning_func</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="编写云函数"></a>编写云函数<a class="hash-link" href="#编写云函数" title="Direct link to heading">#</a></h3><p>以下演示三种云函数的定法，它们的区别主要是函数接受的参数不同：</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="编写object"></a>编写object<a class="hash-link" href="#编写object" title="Direct link to heading">#</a></h4><p>object函数，有一个id参数需要提供：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightning_crm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">models </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Customer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@lightning_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hello_customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">pk</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Greeting to </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">customer</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="编写modle函数"></a>编写Modle函数<a class="hash-link" href="#编写modle函数" title="Direct link to heading">#</a></h4><p>model函数无额外的参数需要提供：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@lightning_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;send_report&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">send_report</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># do some email sending jobs ....</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="编写批量操作函数"></a>编写批量操作函数<a class="hash-link" href="#编写批量操作函数" title="Direct link to heading">#</a></h4><p>批量操作函数需要一个ids(id列表)参数：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@lightning_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;upgrade_vip&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">upgrade_vip</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ids</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> level</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Custumer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">id__in</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ids</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">level</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">level</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;OK&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>以上演示了云函数的编写方式，里面有三个关键点需要掌握：</p><p><strong>1. lightning_func 装饰器的使用。</strong></p><p>lightning_func 装饰器用于向lightning注册云函数，它接收以下几个参数：</p><ul><li><p><strong>name</strong>: 必填，云函数名，英文、数字、下划线的组合。在一个model下，必需唯一。</p></li><li><p><strong>model</strong>: 指定模型，必填，lightning会把该函数挂载某个model下。</p></li><li><p><strong>login_required</strong>:是否要求登录才能调用。默认是True。</p></li><li><p><strong>staff_required</strong>:是否要求员工（后台管理员）才能调用，默认是False。</p></li><li><p><strong>superuser_required</strong>:是否要求超级管理员才能调用，默认是False。</p></li><li><p><strong>permissions</strong>: 所需权限。前三个xxx_required是常见的权限，更多个性化的控限控制可在此定义。该参数接受一个数组，数组元素为字符串或一个权限类：</p><ul><li><p>字符串：即django的auth应用中 Permission 模型的code，可指定有某个Permission的用户才能调用该函数。</p></li><li><p>权限类：继承于lightning.BasePermission的权限类。该类需要实现以下方法：</p><p><code>has_permission(self, user, model, func_name, params, request)</code></p><p>方法返回True代表有权限，False代表无权限。</p></li></ul></li></ul><p><strong>2. 云函数的参数</strong></p><p>云函数要求的参数有：</p><ol><li><strong>user</strong>, 必须，代表当前用户。</li><li><strong>id</strong>, 可选，当编写Object函数时，才需要提供该参数。</li><li><strong>ids</strong>, 可选，当编写批量操作函数时，才需要提供该参数。</li><li><strong>**kwargs</strong>，必须。lightning需要注入一些额外的参数，如：<ul><li>view_context，请求上下文，通过该上下文可以获得request, view等的访问权限。</li></ul></li><li>其他，介于user与 **args之间的参数，用户根据需求进行自定义即可，这些参数的值类型应该是可序列化为JSON的类型，包括Python的几种内置数据类型。</li></ol><p><strong>3. 云函数返回值</strong></p><p>云函数可以返回以下格式：</p><ol><li>Python内置数据格式，如str, int, float, bool, datetime，list, dict等，简言之，能够被json.dumps处理的返回值均可。</li><li>Django Model实例，返回的实例必须是当前云函数装饰器中同样的Model，否则会出错。</li><li>Django QuerySet，返回的QuerySet必须是当前云函数装饰器中同样的Model，否则会出错。</li><li>django.http.HttpResponse实例。</li><li>django_restframework.response.Reponse实例。</li><li>无返回值。</li></ol><p>以下是完整的示例：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightning</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">decorators </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> lightning_func</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightning_crm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">models </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Customer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightning </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> BasePermission</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TestPermission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BasePermission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">has_permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> func_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">is_superuser </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain"> func_name </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;hello&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@lightning_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">Customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> permissions</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;change_customer&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TestPermission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hello_customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;just say hi to </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(130, 170, 255)">id</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="使用云函数"></a>使用云函数<a class="hash-link" href="#使用云函数" title="Direct link to heading">#</a></h2><p>云函数有两种使用方式：</p><ol><li>作为接口调用，云函数的本质是一个接口，所以，可以当作接口来调用。</li><li>在管理界面上，作为单行数据的操作项或模型的全局操作使用。</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-作为接口"></a>1. 作为接口<a class="hash-link" href="#1-作为接口" title="Direct link to heading">#</a></h3><p><strong>路径</strong>：云函数使用统一规格的请求路径: <code>/basebone/{app_label}__{model_name}/func/</code>，其中<code>app_label</code>与<code>model_name</code>因不同的Model而异，两者之间是双下划线。</p><p><strong>方法</strong>：POST</p><p><strong>请求体</strong>：为JSON object，即Content-Type为 <code>application/json</code>，有两个参数：</p><ul><li>func_name: 云函数名，即使用lightning_func注册时指定的name。</li><li>params: JSON object, 里面的属性即对应云函数的参数（user与**kwargs之间的参数）。</li></ul><p><strong>返回结果</strong>：为JSON object，有以下属性:</p><ul><li>error_code: 字符串，为&quot;0&quot; 代表成功。</li><li>error_message: 错误消息，当error_code不为&quot;0&quot;时有值。</li><li>result: 云函数的返回值，经过JSON序列后之后的数据。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="21-作为行操作项"></a>2.1 作为行操作项<a class="hash-link" href="#21-作为行操作项" title="Direct link to heading">#</a></h3><p>行操作项是指在管理界面的数据表格右侧的操作菜单，即对某一条数据进行操作的选项。lightning的管理页面配置支持调用云函数作为一个操作项，操作步骤如下：</p><ol><li>打开指定Model的页面配置面板，在列表页设置 -&gt; 操作项 一节中，添加操作项，选择云函数，点击确认创建一个新操作。</li></ol><p><img alt="添加云函数操作" src="/lightning-doc/assets/images/action-cloudfunc-5e119bd2be38aff926bf21e158d5b2f8.jpg"></p><ol start="2"><li>在操作项列表中展开刚创建的操作，可修改操作名（即菜单名）,函数名填上云函数的名字(lightning_func装饰器里用的name),再填写json object参数，lightning会自动增加id字段到该参数里面。</li></ol><p><img alt="配置云函数" src="/lightning-doc/assets/images/func-config-cd4dde544b3bfb536b0b24125f566b26.jpg"></p><ol start="3"><li>保存配置即可看到操作菜单新增了一项。</li></ol><p><img alt="新操作项" src="/lightning-doc/assets/images/action-new-b954a2cb54c69c4bf49de679e40758dc.jpg"></p><ol start="4"><li>此时，在表格上任意一行上点击新建的操作项，该操作将调用指定的云函数，成功后会提示成功并重新加载页面的数据。</li></ol><p><img alt="操作成功" src="data:image/jpeg;base64,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16oV3HBlpSe/uscc/vzW5pK3jzePj77TfDP2C/tDGTTwIJMljRs3ztx2222pVd944w3z8ssvp9ZLUgCOn3zyiYF9mZ5//nnz+eefS1JwGfY++ugjKz9q1Chz3333BetKwa+//roPqxdeeEGyEsvPPfec+fDDDxPl8ghknYM+PR/N7VuIjKvT7XVdOdRgBpQxcWkTOX8cKnmoyzL5WfNtHl4sUfWbsaPM8NcPtb9b13s7UV4KjBkzxpx00klm6623tuSnnnrK/Pjjj1Kkr7z66qubGWec0daffvppK7f88subTz/91Oyxxx59crKw8MILm4suusiSXnzxRYP2kGBn6NCh5tlnnzXffvut+eabb8wXX3xh3n//fTPbbLMZtLXkkktaWfxzww03mA022MDMPffclrbXXnuZL7/80toAAXbXXHNNc8wxx1i+/Oess84y6MchhxxiLrvsMvukvdFGG0mRoPLo0aPNlVdeaTbeeGNzzjnnmNVWW80cdNBBQbq33HKLWWWVVcyCCy4YJB8qJOcaylxFSDr/QB95obZVrngENDgUj2klFuUNFtcByjGPk03DG/HemWnErSx0hi3yn6n1qIDVAJw90oQJE8y9995rNt98c1tfYokl+oKDJfz9z1xzzWWuvfZaGxS33HJLW5522mnNBx98YC644II+0aOPPtostNBC5rfffjOTTz65ddYow+FD/rXXXjOPPvqomWSSSWzbfYqeAvTOO+88s8ACC1jugw8+aB577LEBku+8845BIDvuuOPMd999Z26//Xbr3K+44ooBsptssomZc845Lf3xxx/vO9ilIHD55ZdfDFYBO++8s7n66qvNUkstZZ3+u+++a4488kiK2nzxxRc3F154YT9aWRXMPQ0CZaFbnF0NDsVh2VFLRTh3vClShJ3vxo42j35xR+rxQ2fzeYaZmSafPVb3vffes0/R2FYaP368OeKII8x8881n9t9//z49OMIHHnjA4MmbCU/2l156qX3Chy62WvBEDqd6//33GwQQPKUjYRtoiimmoKrN4aQ//vhjM2LECDP//PNbmb333tu8/vrr5p577rGBAUEFT+R33XWX3WKCg33llVdsW3DCaG/DDTc0t956q+H/5ezPP/+0T/KyMVyLM844w+yzzz5m9tlnN2eeeaZZY4017PXBKmabbbaR4v36ut9++5nDDz/cTDbZZH0yv//+u/n5558NVhBICIRY8QA/rKAQSLH9hf5ec801tm+nn366+f77781LL71kx43AgvkBbLGKyZtgC+McMmRIKlPQ05VEKsgKEdbgUAiM5RpJ68ClfFS5yB6/8v3T5pcJ/u0dtjPdJDOZw5Yebl7/4Xnzj496n1ChA9115+zdJqKsmy+yyCLm7LPPNj/99JN9Wkc5JMHxQ/byyy+320oIKkgjR440p512mqXTDhw6Ak5UwuoBW0rYyppuuokH6jfeeKPZbLPNrBr00d7BBx9st5U23XRTu4XFrS84eGwvwSnjh1UCHDLS8OHDzTPPPGN22GEHy7vzzjttwEFQwSpi/fXXt3JR/2y77bZmqqmm6mOPHTvWnH/++Wb77be3jh8BDv3kVtukk05qgxucLspIWC0h7bvvvgZ9xw9BZq211rL0Mv6Rjj+qXEa7ajMZAQ0OyRi1RkIGiiIH9f7Pryaa23OxE8wP477tCwxUgG5ScKCszOFk55hjDklKLMPJfvbZZ9b5wRkvuuiiNthcf/311uljjz4uYQXwyCOP2KdwyGEF8NBDDxns0UclrEjwlI6tpDfffNOuLrBCwOpl2LBhVg1bTJBZbrnlDJw6tnzgqOnIn3zyyT7HDQXIwenLhK0yrhxWXHFFs8wyy5ipp57argRw3c8999wBqw+pL8s//PBDX9sYY5lP7TIgyD7ElX06PlqcDeUlI6DBIRmjVkrgZioqjfz+qX6m/mOB/c2SM6xiznr1APPrhJ/M5vMOM3NPtZA545V9+smh4uoOEHAIOFvACgBv4Dzas+cfkjBWOGDs4WPvHU/rq666qlVddtllrfM79thjY1cOf/zxh1l77bXtD1tJ2B4BDU/22I6CE5XbJdi2wuoAzh6rFAQl7OsjYasLjpsJ+jgIx8ExVijYpuJqBDLTTz+9weqJCdtObkIQwvkHVkUYL4IDzkzw1hG2ibBFNc0007hq3jq2lmaYYQbLgy1uh3mFMxBhs8yAk6FLquJBQIODBxQl5UPgf3q2jY6a9r/NXoufZP756Qh76HzayL3M6DG9h8dprePM4aabbrIOHo5lhRVWMCeffHKiGWwVXXLJJeaJJ54wCAI42IVjhXP2rRKwfRL1JtMBBxww4BAZe/dMCDh4I+jiiy+27YF32GGHme22267vwJoBYtZZZ7VqO+64o83xZpBMW221lazag+Rdd921H40VnKUAE7zFheCEswquIBZbbDHz1ltvmZtvvtkcddRRVInNcb6AVRm32HBGIYNerLIyW4WABocWXE44hyrTcjOuYe4fdVO/Llz17hnm1BWvM4sutZy5/oPh5qXvBr6dAwXoJiWcNWCfH0/ge+65p6FTTdLDfvnSSy9t3zDCvjqfuPGWE4IAt21gBysRrAiikjyQxZtKJ5xwQt93BNTB4fXMM89sD7rh4NHmww8/THbfeQXeGmKaZ555+h0ukx6a48AZr9PSgSNYYPWBhGB16qmnmllmmcWst956kSYxfxBIsV2Fw28c1PNwHisivMZbdUIfdbXR2aswuLPNaWudREAGDZaZF9mPhaddZoA5rBIufftE887PI81tH186gE+CT5c85iuttJI58MADDZ6E0yR8f4DDVT6pS12sEnCGwJ902FIuTRlvNOHtpJlmmsmqYTsGjhrbPTi4BvZ4Mr/77rstHbwQh4etMHxHwZ9c3eApn99ToFGcF3C8CIx4QwurHrTD7zYghzJWZPjgbt1117VBBHS88QXcmBBsuBIhLWsu5x7KrDOHXVnO2k6UXpm2o9psMr36R4Imo1dA34uesCH2pIwsZx3OsjP+m5lm6PQD3lh64dv/NfhFJehAt64Jh74448D+fZaEJ3p8AIctJzh0OGp864AzAAQQvGEUkvAGE4IOk3ySx7YRtoCwdQa7ODDHmQxWTYceeqg928Arteuss44900CgRVDCa8DY+sKrswgOWMHgwz4cjOO8hAlBZMopp2S1oznmZkjw7GinuqgxXTl00cUua6j4TmHtObdMbR46Sd84SKPY/45K8qnYlcHTr5uwBYQnZ/6++uorV8R+uIa3hqQzhhC2WuISAy6CAZwvXoGVZwb4fuKOO+4wJ554onXicbbAw5M7Przjj84a7eAsBt8wINhghYIzD4x3t912sw4fB+Yjel5jxZtSOCDHG1orr7yy3eLC9w277LKLlcMB+ymnnGK22GKLvpUH2sZX4fhwUFP3IaArh+675qWMGF864/A5TUrzdTQcKj4+w9aNTHiXH18W428S8W0g8vERGF4LhYM7/vjjSbY5Dm7hTJnwLYI8GIbjxt47Dr/51TXauO666wxeLXXbgh08rSOY4PVWOGd8t4B9fzhgmfDW0FVXXWU/esPfT5JvIkm5pPKrr75qv21AH5HQX6wgsOLZfffd7WoFW1sY60477WQPtl382AbelsIWFd6YQqDFqgOY4ENC3+E99TRvLwKDfvn1t2pPM9uLbdDI+JQZJ+yTkTSUWZd5P3rPk6GtG8j27u3iaRFPwfPNO09c86l4+KN6173/Xz1/bG+UV2+WyecyOy18mFlztk28/CgiHCH+DAW2eOTHXlgB4MtfHMhiT97dH8dBs/sqKPbV8beN+ASONvEmEezQ0fr6AeePA2a0j1dhZT8oj4CAPX+8Ruom/IE+vMLKN4FcPl63xbbTvPPO28fCEz9emZVvRvUxewrYCuKf0QAdjh0H+Dx8pyzowIgfvJHOHGPHfMBWGBJeicWWDjB1V07USZt/8ulntg8IWLDd85/p+be33END6qX30lhnDp5MSXUpy7KrQ7rmAxEYNGbsWA0OA3HpGIXOPKpBH9+lWacPj9+TyCONddz4kmbLCA49v7n+/hs9UX1IS9c/2Z0Wse6QH9UTyIYgMPQFh78DQ4/T57cUGhzqMxcGjRs3XoNDhdeDzjuqCz6+S7OOPkNw4MphjjkGflQV1R+lKwJZEfjyy9HOykGDQ1YsO6E3dMgQPZPuBNBRbbiO3pXz8V1aSHDAipxyzHtX6fps4GKu9XIQgK/Bb+K2kgaHcpAuxupQ3YMrBsi6W+F1Ro4VAxKX8HXvu/avHQhwvjF3t5IwSvKQs86cNMvo+SepTjmZuzqSp+X+CGhw6I9Ha2vypmAZOcutHbgOrDYIcL7JHJ1jXZY5L2XOMuWQyyT5ki7LITJSvpvLuqdU86uvk7nmF0i7pwi0FAENDhVf2CzOP4tOxcPU5hUBRaBhCGhwaNgFy9NdDSp50FPdMhDQOVkGqsXY1OBQDI61sZL2ZksrX5uBakcah0DauZZWvnGA1LzDGhxqfoHydE/eXL4yaJKepy3VVQSSEJDzTc67qHKSPeWXi4AGh3Lxra11eUPWtpPasVYikGXuZdFpJXgdHJQGhw6CXVZTcTcOeczRh6hyWf1Tu4oAEIiad6QzLwutsu2X1e+q7GpwqAr5GrXLj+Jq1CXtSssQ0DnWvAuqwaF51yyox76nJNBIZxn5mN/H9H01HWRchRSBFAggMGCOyTkHddZdU6DHpSR+nK7ywhHQ/59DOFaVSeJmcP+ekkuT9aiyHABkKDdu/Djzx49/2D/fjRsZbSHnD3r8e0xuWdrUcvcgwPmDEcsy/iQGf6CjjD8VThnmPqTAY4oqk+/mUt7laT0bAhocsuHWKC3cOHDuzNl51OVNhTJuZsrKOmhIzN2yrw6apuYjIOcIRiPrLCPnD3OIZV8uEQHftSn5STxXVuvFIaDBoTgsK7WEm0w67qjO8GaUAYCyeMLD//yHtpjTLnPKIyeNueRpuV0IYD5w/siRkUY+c8hErRqkjLSl5fogoMGhPtei0J7whoXTRjnKeVOOjeNmxnYSdahHGuWQ07akke7StN48BNy5wRH46FgtIIFHvm8FQRtuTh2p78povbMIaHDoLN7e1nBD0Al7BQogsg3ehDDpc+7ksz+sMyfdpxvaTdoIlVe5YhHgtcxjlTbcHDZBw88NGFKWMpQP7QttSHkfTfLTtuHqdmtdg0NDrjxuANepujTcjHjCl4kyzMFjOSqHHbTF9pBDlknySNO8uxDAfJBzAqNnXfIkzZUhYq4M6cgZYCRNy51BQINDZ3CupBXcdHTw6ICsM5CQ5tZBx8+3nURbHJRsgzTN24kA5gSTLJMmnTn5pLl16JBGfbdOuuadR0CDQ+cxL7VFOnnZCG44+fRPZy7poEGXPOiTxjJz9wZ265RDrqm5CPiuqzsayjAHn2Xksix5LLt80JnIi6qTnpS7dpLkld+LgAaHhs8ETHzp0N3huHzeKNBBGT+uDkhzbaDu2vHJSBrbkTQttw8BziE5MpfGucAVBGRdGdJcO7LuK9O2j6e0fAgM6nEI+n+Yz4dhYdohl8In46O5Zw+QoZybYwBS3scnTQ7WR5N8LbcTAZ9DljSWmQMFNzCARj5ylkFHkvK9lInyrCN39SSP5RAZymo+EQFdOUzEorElTP4QR005N8fAuaUEO7yZKCdpEiTKSZoMMpKu5WYigGvsu86+0fhkXRptubnPnqRRXtK0XC4CunIoF99U1kMcPAz65Hw011FTJiqXtikjByBpsixltNwdCEhnLcscPWnMQWc5KqdukasG2S7tax6GgAaHMJw6JhXidKNkXDrqPhoGQzpzSXPLvnoUDXRN7UaAzl2O0qXJuq9MGnPaQt1HI1/mrpzksRwiQ1nN+yOgwaE/HpXXpLOO60yUnEtH3UejbfKYJ9HJj8pdO1FySm8GAmmdK+WZc5SsMwddlln30WhD5q6c5MlyqJzU0XIvAnrm0PKZwJtDOm3QWCcfMJCGMunMwZN8yPgS5X08pbUXAd9WEEeLOeHOC1/dpVE/a160vaz9aKqerhxqeOVCnDC6HSXno4Pm0t06bfroLkwhMq6O1tuDQIjjhYxPzqWFyhE9V590Nw+Vc/W03ouArhxaOBNwU7jOmzeKpEfRJF3KS6goI2ksR+mQr3kzEIi7xlEjgE6Uno8eJe+TjWpT6eUgoCuHcnDNbTXUwcbJ+XikMWdH3TrpzJP4lNO8OxFIcuYun3XmEjUfjfw4HmWQh8pJHS33R0CDQ388alNL44zjZH08SZNlDN6txwGSRjbOjvKah0Co83XlZF2WiYCPFsKjDPM4O5TRPB4BDQ7x+FTGTet44+SjeJIuyxy0j0ZeaF6EjdC2VK4YBPI6Vp++pMmy7HEUHTJxPGkjrayrq/WJCOiZw0QsalXCzVCUY42yxRsO7bAcBULWviTZjWpP6c1CQF5nWZajiKJDJo4nbWi5cwjoyqFzWGdqKY1TTpLNy3cHkGTPldd6OxDI4sjjdOJ4QCyJL1FNIyv1tDwQAQ0OAzGpHSWNE06STeJj8CEyRYLU6faK7HtTbFXhNJPaTOID2xAZXoM0stTRPBoBDQ7R2NSKk8aBhsiGyACAULlagaWdqQyBUAcdIhciIweaVl7qankgAhocBmJSS0paJx0qHyonQcmiI/W13A4EsjjjEJ0QGRfBLDquDa33R0CDQ388al3L4pTT6KSRTQtUmbbT9kXl/QiU6WBDbYfKyRFk0ZH6WvYjoMHBj0ttqVmdbFq9tPK1BUw7VhkCaZ12WnkMLItOZYA0rGENDg27YOhuVsedVS9Pmw2EV7ucAYE8Tjqrbla9DMPrShUNDg297HVx9Hn60VDou7rbRTrkPLby6Hb1BUwxeP0ILgVYbRHljVWEY6ettmCj4ygfgbxzJq9++SNsRwu6cmj4dSzCwQOCouw0HE7tfkkIFOXQi7JT0jBbZVaDQwsuZ9GOvWh7LYBYh5ASgTKceBk2Uw6rq8Q1OLTkcpft0Mu235LL0LXDKNtxl22/ay9czMA1OMSA00RW1U686vabeM3q2uc6OOQ69KGu16fsfmlwKBvhiuyrk64IeG22MAQ0MBQGZSZD+rZSJtjqr8QbS4NE/a+V9rA/Apy7/ala6zQCGhw6jXiH2+ONpkGiw8Brc6kR4FxNragKpSCgwaEUWOtnlDeeBon6XZtu7hHnZTdjUNexa3Co65UpqV+8GTVIlASwmg1CgPMwSFiFKkFAg0MlsFffqLw5NVBUfz3a3AM519o8zraNTYND265ohvFE3bwaNDKAqSoWgag5pfA0BwENDs25Vh3vadINrsGj45ek0gaT5kOlndPGC0dAg0PhkHaPQXUW3XOtdaTdh8Dg7huyjlgRUAQUAUUgCQENDkkIKV8RUAQUgS5EQINDF150HbIioAgoAkkIaHBIQkj5ioAioAh0IQIaHLrwouuQFQFFQBFIQkCDQxJCylcEFAFFoAsR0ODQhRddh6wIKAKKQBICGhySEFK+IqAIKAJdiIAGhy686DpkRUARUASSEPh/al9+5b2FrqwAAAAASUVORK5CYII="></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="22-作为全局操作项"></a>2.2 作为全局操作项<a class="hash-link" href="#22-作为全局操作项" title="Direct link to heading">#</a></h3><p>全局操作是指在管理界面数据表格左上角的操作按钮，例如新建按钮。lightning的管理页面配置支持调用云函数作为一个全局操作项，操作步骤与行操作项类似，在此不赘述，全局操作项在配置面板的位置：列表页设置 -&gt; 全局操作。添加云函数类型操作后，可以配置调用的云函数及参数。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="23-作为批量操作项"></a>2.3 作为批量操作项<a class="hash-link" href="#23-作为批量操作项" title="Direct link to heading">#</a></h3><p>全局操作是指在管理界面数据表格左上角的批量操作选项。lightning的管理页面配置支持调用云函数作为一个全局操作项，操作步骤与行操作项类似，在此不赘述，全局操作项在配置面板的位置：列表页设置 -&gt; 批量操作，添加云函数类型操作后，可以配置调用的云函数及参数。</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://gitee.com/gitmen/lightning-doc-src/blob/master/docs/guide/function.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/lightning-doc/docs/guide/field"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 内置字段</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/lightning-doc/docs/guide/signal"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">信号 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#定义云函数" class="table-of-contents__link">定义云函数</a><ul><li><a href="#导入lightning_func装饰器" class="table-of-contents__link">导入lightning_func装饰器</a></li><li><a href="#编写云函数" class="table-of-contents__link">编写云函数</a></li></ul></li><li><a href="#使用云函数" class="table-of-contents__link">使用云函数</a><ul><li><a href="#1-作为接口" class="table-of-contents__link">1. 作为接口</a></li><li><a href="#21-作为行操作项" class="table-of-contents__link">2.1 作为行操作项</a></li><li><a href="#22-作为全局操作项" class="table-of-contents__link">2.2 作为全局操作项</a></li><li><a href="#23-作为批量操作项" class="table-of-contents__link">2.3 作为批量操作项</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">文档</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/lightning-doc/docs/">简介</a></li><li class="footer__item"><a class="footer__link-item" href="/lightning-doc/docs/start/">快速开始</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">社区</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lightning" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/jeff_kit" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">更多</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/lightning-doc/blog">博客</a></li><li class="footer__item"><a href="https://github.com/git-men/lightning" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2021 gitmen Ltd.</div></div></div></footer></div>
<script src="/lightning-doc/styles.226bd103.js"></script>
<script src="/lightning-doc/runtime~main.e3f81d46.js"></script>
<script src="/lightning-doc/main.d60ecdbd.js"></script>
<script src="/lightning-doc/1.3de079d2.js"></script>
<script src="/lightning-doc/44.64178a3e.js"></script>
<script src="/lightning-doc/45.9bff3e8c.js"></script>
<script src="/lightning-doc/935f2afb.a3e23e6e.js"></script>
<script src="/lightning-doc/43.f7416efc.js"></script>
<script src="/lightning-doc/08734d2c.82d2cef3.js"></script>
</body>
</html>